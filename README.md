# Поисковый движок на Spring Boot

Проект реализован на основе Spring Boot и сборщика Maven с использованием MySQL, JPA и Hibernate. Приложение индексирует 
сайт(ы), чтобы потом находить наиболее релевантные страницы по любому поисковому запросу.

## Настройка для запуска

**1. Клонирование проекта на личный ПК**

```
git clone https://github.com/nikitaln/web-search-engine.git
```

**2. Создание MySQL таблицы**

```
create database search_engine
```

**3. Изменение mysql username и password в соответствии с вашей установкой**

+ открыть `application.yml`
+ изменить `spring:datasourse:username` и `spring:datasourse:password`

**4. Добавление индексируемых сайт(ов)**

+ открыть `application.yml`
+ изменить `indexing-settings:sites: - url:` и `indexing-settings:sites:name:`


**5. Запуск приложения**

Приложение запускается на локальном порту http://localhost:8080

## Проверка API

Для проверки API можно воспользоваться веб-интерфейсом

* **Запуск полной индексации**

```bash
GET http://localhost:8080/api/startIndexing
```
Метод запускает полную индексацию всех сайтов или полную переиндексацию, если они уже проиндексированы.
Если в настоящий момент индексация или переиндексация уже запущена, метод возвращает соответствующее сообщение об ошибке. 

Формат ответа в случае успеха:

```json
{
  "result": true
}
```

Формат ответа в случае ошибки:

```json
{
  "result": false,
  "error": "Индексация уже запущена"
}
```

* **Остановка текущей индексации**

```bash
GET http://localhost:8080/api/stopIndexing
```

Метод останавливает текущий процесс индексации (переиндексации). Если в настоящий момент индексация или переиндексация
не происходит, метод возвращает соответствующее сообщение об ошибке.

Формат ответа в случае успеха:

```json
{
  "result": true
}
```

Формат ответа в случае ошибки:

```json
{
  "result": false,
  "error": "Индексация уже запущена"
}
```

* **Добавление или обновление отдельной страницы**

```bash
POST http://localhost:8080/api/indexPage
```

Метод добавляет в индекс или обновляет отдельную страницу, адрес которой передан в параметре.
Если адрес страницы передан неверно, метод должен вернуть соответствующую ошибку.

Формат ответа в случае успеха:

```json
{
  "result": true
}
```

Формат ответа в случае ошибки:

```json
{
  "result": false,
  "error": "Данная страница находится за пределами сайтов, указанных в конфигурационном файле"
}
```

* **Статистика**

```bash
GET http://localhost:8080/api/statistics
```

Метод возвращает статистику и другую служебную информацию о состоянии поисковых индексов и самого движка.
Если ошибок индексации того или иного сайта нет, задавать ключ error не нужно.

Параметры:

Метод без параметров

Формат ответа:

```json
{
  "result": true,
  "statistics": {
    "total": {
      "sites": 1,
      "pages": 112,
      "lemmas": 1785,
      "indexing": true
    },
    "detailed": [
      {
        "url": "https://www.playback.ru/",
        "name": "PlayBack.Ru",
        "status": "FAILED",
        "statusTime": 27,
        "error": "Остановка индексации пользователем",
        "pages": 112,
        "lemmas": 1785
      }
    ]
  }
}
```

* **Получение данных по поисковому запросу**

```bash
GET http://localhost:8080/api/search
```

Метод осуществляет поиск страниц по переданному поисковому запросу (параметр query).

Формат ответа в случае успеха:

```json
{
    "result": true,
    "count": 1,
    "data": [
        {
            "site": "https://www.playback.ru",
            "siteName": "PlayBack.Ru",
            "uri": "/catalog/1305.html",
            "title": "Купить наушники и колонки",
            "snippet": "<b>Наушники для планшетов и смартфонов</b>  ничем не отличаются от обычных наушников для  плееров...",
            "relevance": 0.11612903326749802
        }
    ]
}
```

Формат ответа в случае ошибки:

```json
{
     "result": false,
     "error": "Задан пустой поисковый запрос"
}
```

